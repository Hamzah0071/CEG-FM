<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guide BDD CEG FM</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .nav {
            display: flex;
            gap: 10px;
            padding: 20px;
            background: #f8f9fa;
            flex-wrap: wrap;
            justify-content: center;
        }

        .nav-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            background: #667eea;
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .nav-btn:hover {
            background: #5568d3;
            transform: translateY(-2px);
        }

        .nav-btn.active {
            background: #764ba2;
        }

        .content {
            padding: 30px;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .card h2 {
            color: #667eea;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card h3 {
            color: #764ba2;
            margin: 20px 0 10px 0;
            font-size: 1.2rem;
        }

        .table-schema {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #667eea;
        }

        .table-schema h4 {
            color: #333;
            margin-bottom: 10px;
        }

        .field {
            display: grid;
            grid-template-columns: 200px 150px 1fr;
            gap: 15px;
            padding: 8px;
            border-bottom: 1px solid #ddd;
        }

        .field:last-child {
            border-bottom: none;
        }

        .field-name {
            font-weight: 600;
            color: #667eea;
        }

        .field-type {
            color: #764ba2;
            font-family: monospace;
        }

        .field-desc {
            color: #666;
        }

        .example-code {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
        }

        .example-code .keyword {
            color: #ff79c6;
        }

        .example-code .string {
            color: #50fa7b;
        }

        .example-code .comment {
            color: #6272a4;
        }

        .example-code .function {
            color: #8be9fd;
        }

        .relationship {
            display: flex;
            align-items: center;
            gap: 20px;
            margin: 20px 0;
            padding: 15px;
            background: #f0f7ff;
            border-radius: 8px;
        }

        .table-box {
            background: white;
            padding: 15px 25px;
            border: 2px solid #667eea;
            border-radius: 8px;
            font-weight: 600;
            color: #667eea;
        }

        .arrow {
            font-size: 24px;
            color: #764ba2;
        }

        .tip {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .tip strong {
            color: #856404;
        }

        .warning {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .warning strong {
            color: #721c24;
        }

        .success {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .success strong {
            color: #155724;
        }

        .flow-diagram {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }

        .flow-step {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .step-number {
            background: #667eea;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 3px solid #667eea;
        }

        @media (max-width: 768px) {
            .field {
                grid-template-columns: 1fr;
                gap: 5px;
            }

            .relationship {
                flex-direction: column;
            }

            .nav {
                flex-direction: column;
            }
        }

        .quick-ref {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .quick-ref-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .quick-ref-card:hover {
            transform: translateY(-5px);
        }

        .quick-ref-card h3 {
            color: white;
            margin: 0 0 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìö Guide Base de Donn√©es CEG FM</h1>
            <p>Tout comprendre sans l'aide d'une IA</p>
        </div>

        <div class="nav">
            <button class="nav-btn active" onclick="showSection('intro')">üìñ Introduction</button>
            <button class="nav-btn" onclick="showSection('structure')">üèóÔ∏è Structure</button>
            <button class="nav-btn" onclick="showSection('relations')">üîó Relations</button>
            <button class="nav-btn" onclick="showSection('exemples')">üíª Exemples SQL</button>
            <button class="nav-btn" onclick="showSection('php')">üêò Exemples PHP</button>
            <button class="nav-btn" onclick="showSection('scenarios')">üéØ Sc√©narios</button>
        </div>

        <div class="content">
            <!-- SECTION INTRODUCTION -->
            <div id="intro" class="section active">
                <div class="card">
                    <h2>üéì Bienvenue dans votre Base de Donn√©es</h2>
                    <p>Cette base de donn√©es g√®re tout le syst√®me scolaire du CEG FM. Voici les concepts cl√©s :</p>

                    <div class="quick-ref">
                        <div class="quick-ref-card">
                            <h3>üë• Les Personnes</h3>
                            <p>Infos communes √† tous (nom, pr√©nom, date de naissance...)</p>
                        </div>
                        <div class="quick-ref-card">
                            <h3>üîê Les Comptes</h3>
                            <p>Login, mot de passe, r√¥le (admin, prof, √©l√®ve)</p>
                        </div>
                        <div class="quick-ref-card">
                            <h3>üìÖ Ann√©e Scolaire</h3>
                            <p>P√©riode de r√©f√©rence pour tout le syst√®me</p>
                        </div>
                        <div class="quick-ref-card">
                            <h3>üéí Classes</h3>
                            <p>Groupes d'√©l√®ves par niveau</p>
                        </div>
                    </div>

                    <h3>üîë Concept Fondamental : La S√©paration</h3>
                    <div class="tip">
                        <strong>üí° Astuce :</strong> La base est organis√©e en 3 niveaux :
                        <ol style="margin-left: 20px; margin-top: 10px;">
                            <li><strong>personnes</strong> = Informations personnelles (identit√©)</li>
                            <li><strong>utilisateurs</strong> = Compte de connexion (email, mot de passe)</li>
                            <li><strong>eleves/professeurs</strong> = R√¥le sp√©cifique (matricule, infos pro)</li>
                        </ol>
                    </div>

                    <h3>üìä Pourquoi cette organisation ?</h3>
                    <p>Imaginons Jean DUPONT :</p>
                    <div class="flow-diagram">
                        <div class="flow-step">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <strong>Table personnes</strong><br>
                                Jean DUPONT, n√© le 15/03/1995, Masculin, t√©l: 034...
                            </div>
                        </div>
                        <div class="flow-step">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <strong>Table utilisateurs</strong><br>
                                Email: jean.dupont@ceg.mg, R√¥le: prof, Statut: actif
                            </div>
                        </div>
                        <div class="flow-step">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <strong>Table professeurs</strong><br>
                                Matricule: PROF2024001, Sp√©cialit√©: Math√©matiques
                            </div>
                        </div>
                    </div>

                    <div class="success">
                        <strong>‚úÖ Avantage :</strong> Si Jean change d'email ou de t√©l√©phone, on modifie une seule table. Son identit√© et son r√¥le restent intacts !
                    </div>
                </div>
            </div>

            <!-- SECTION STRUCTURE -->
            <div id="structure" class="section">
                <div class="card">
                    <h2>üèóÔ∏è Structure D√©taill√©e des Tables</h2>

                    <div class="table-schema">
                        <h4>1Ô∏è‚É£ TABLE : personnes</h4>
                        <p><strong>R√¥le :</strong> Stocker l'identit√© de toute personne (√©l√®ve, prof, admin)</p>
                        <div class="field">
                            <span class="field-name">id</span>
                            <span class="field-type">INT</span>
                            <span class="field-desc">Identifiant unique (cl√© primaire)</span>
                        </div>
                        <div class="field">
                            <span class="field-name">nom</span>
                            <span class="field-type">VARCHAR(50)</span>
                            <span class="field-desc">Nom de famille en MAJUSCULES</span>
                        </div>
                        <div class="field">
                            <span class="field-name">prenom</span>
                            <span class="field-type">VARCHAR(50)</span>
                            <span class="field-desc">Pr√©nom(s)</span>
                        </div>
                        <div class="field">
                            <span class="field-name">date_naissance</span>
                            <span class="field-type">DATE</span>
                            <span class="field-desc">Format : YYYY-MM-DD (ex: 1995-03-15)</span>
                        </div>
                        <div class="field">
                            <span class="field-name">sexe</span>
                            <span class="field-type">ENUM('M','F')</span>
                            <span class="field-desc">M = Masculin, F = F√©minin</span>
                        </div>
                        <div class="field">
                            <span class="field-name">telephone</span>
                            <span class="field-type">VARCHAR(15)</span>
                            <span class="field-desc">Num√©ro de t√©l√©phone</span>
                        </div>
                        <div class="field">
                            <span class="field-name">adresse</span>
                            <span class="field-type">TEXT</span>
                            <span class="field-desc">Adresse compl√®te</span>
                        </div>
                    </div>

                    <div class="table-schema">
                        <h4>2Ô∏è‚É£ TABLE : utilisateurs</h4>
                        <p><strong>R√¥le :</strong> G√©rer les comptes de connexion</p>
                        <div class="field">
                            <span class="field-name">id</span>
                            <span class="field-type">INT</span>
                            <span class="field-desc">Identifiant unique du compte</span>
                        </div>
                        <div class="field">
                            <span class="field-name">personne_id</span>
                            <span class="field-type">INT</span>
                            <span class="field-desc">Lien vers personnes (qui est-ce ?)</span>
                        </div>
                        <div class="field">
                            <span class="field-name">email</span>
                            <span class="field-type">VARCHAR(150)</span>
                            <span class="field-desc">Email de connexion (unique)</span>
                        </div>
                        <div class="field">
                            <span class="field-name">password_hash</span>
                            <span class="field-type">VARCHAR(255)</span>
                            <span class="field-desc">Mot de passe crypt√© (jamais en clair !)</span>
                        </div>
                        <div class="field">
                            <span class="field-name">role</span>
                            <span class="field-type">ENUM</span>
                            <span class="field-desc">admin, prof, eleve, parent</span>
                        </div>
                        <div class="field">
                            <span class="field-name">statut</span>
                            <span class="field-type">ENUM</span>
                            <span class="field-desc">en_attente, actif, refuse, suspendu</span>
                        </div>
                    </div>

                    <div class="table-schema">
                        <h4>3Ô∏è‚É£ TABLE : eleves</h4>
                        <p><strong>R√¥le :</strong> Informations sp√©cifiques aux √©l√®ves</p>
                        <div class="field">
                            <span class="field-name">id</span>
                            <span class="field-type">INT</span>
                            <span class="field-desc">Identifiant unique de l'√©l√®ve</span>
                        </div>
                        <div class="field">
                            <span class="field-name">utilisateur_id</span>
                            <span class="field-type">INT</span>
                            <span class="field-desc">Lien vers utilisateurs</span>
                        </div>
                        <div class="field">
                            <span class="field-name">personne_id</span>
                            <span class="field-type">INT</span>
                            <span class="field-desc">Lien vers personnes</span>
                        </div>
                        <div class="field">
                            <span class="field-name">matricule</span>
                            <span class="field-type">VARCHAR(20)</span>
                            <span class="field-desc">Ex: ELEV2024001</span>
                        </div>
                        <div class="field">
                            <span class="field-name">nom_parent</span>
                            <span class="field-type">VARCHAR(100)</span>
                            <span class="field-desc">Nom du parent/tuteur</span>
                        </div>
                        <div class="field">
                            <span class="field-name">telephone_parent</span>
                            <span class="field-type">VARCHAR(15)</span>
                            <span class="field-desc">Contact d'urgence</span>
                        </div>
                    </div>

                    <div class="table-schema">
                        <h4>4Ô∏è‚É£ TABLE : professeurs</h4>
                        <p><strong>R√¥le :</strong> Informations sp√©cifiques aux profs</p>
                        <div class="field">
                            <span class="field-name">matricule</span>
                            <span class="field-type">VARCHAR(20)</span>
                            <span class="field-desc">Ex: PROF2024001</span>
                        </div>
                        <div class="field">
                            <span class="field-name">specialite</span>
                            <span class="field-type">VARCHAR(50)</span>
                            <span class="field-desc">Math√©matiques, Fran√ßais...</span>
                        </div>
                        <div class="field">
                            <span class="field-name">date_recrutement</span>
                            <span class="field-type">DATE</span>
                            <span class="field-desc">Date d'embauche</span>
                        </div>
                    </div>

                    <div class="table-schema">
                        <h4>5Ô∏è‚É£ TABLE : annee_scolaire</h4>
                        <p><strong>R√¥le :</strong> D√©finir les ann√©es (2024-2025, 2025-2026...)</p>
                        <div class="warning">
                            <strong>‚ö†Ô∏è Important :</strong> Une seule ann√©e peut √™tre active √† la fois !
                        </div>
                    </div>

                    <div class="table-schema">
                        <h4>6Ô∏è‚É£ TABLE : classes</h4>
                        <p><strong>R√¥le :</strong> D√©finir les classes (6√®me A, 5√®me B...)</p>
                        <div class="field">
                            <span class="field-name">nom</span>
                            <span class="field-type">VARCHAR(20)</span>
                            <span class="field-desc">A, B, C...</span>
                        </div>
                        <div class="field">
                            <span class="field-name">niveau</span>
                            <span class="field-type">VARCHAR(10)</span>
                            <span class="field-desc">6√®me, 5√®me, 4√®me, 3√®me</span>
                        </div>
                        <div class="field">
                            <span class="field-name">annee_scolaire_id</span>
                            <span class="field-type">INT</span>
                            <span class="field-desc">Lien vers l'ann√©e</span>
                        </div>
                    </div>

                    <div class="table-schema">
                        <h4>7Ô∏è‚É£ TABLE : inscriptions</h4>
                        <p><strong>R√¥le :</strong> Enregistrer quel √©l√®ve est dans quelle classe, quelle ann√©e</p>
                        <div class="tip">
                            <strong>üí° Pourquoi une table s√©par√©e ?</strong><br>
                            Un √©l√®ve peut changer de classe chaque ann√©e. Cette table garde l'historique !
                        </div>
                    </div>

                    <div class="table-schema">
                        <h4>8Ô∏è‚É£ TABLE : affectations_prof</h4>
                        <p><strong>R√¥le :</strong> Qui enseigne quoi, o√π et quand</p>
                        <div class="field">
                            <span class="field-name">prof_id</span>
                            <span class="field-type">INT</span>
                            <span class="field-desc">Quel professeur ?</span>
                        </div>
                        <div class="field">
                            <span class="field-name">classe_id</span>
                            <span class="field-type">INT</span>
                            <span class="field-desc">Dans quelle classe ?</span>
                        </div>
                        <div class="field">
                            <span class="field-name">matiere_id</span>
                            <span class="field-type">INT</span>
                            <span class="field-desc">Quelle mati√®re ?</span>
                        </div>
                    </div>

                    <div class="table-schema">
                        <h4>9Ô∏è‚É£ TABLE : notes</h4>
                        <p><strong>R√¥le :</strong> Stocker toutes les notes</p>
                        <div class="field">
                            <span class="field-name">inscription_id</span>
                            <span class="field-type">INT</span>
                            <span class="field-desc">Pour quel √©l√®ve-classe-ann√©e ?</span>
                        </div>
                        <div class="field">
                            <span class="field-name">affectation_id</span>
                            <span class="field-type">INT</span>
                            <span class="field-desc">Dans quel cours (prof+mati√®re+classe) ?</span>
                        </div>
                        <div class="field">
                            <span class="field-name">valeur</span>
                            <span class="field-type">DECIMAL(4,2)</span>
                            <span class="field-desc">La note (ex: 15.50)</span>
                        </div>
                        <div class="field">
                            <span class="field-name">sur_combien</span>
                            <span class="field-type">DECIMAL(4,2)</span>
                            <span class="field-desc">Sur 20 ? Sur 10 ? (d√©faut: 20)</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SECTION RELATIONS -->
            <div id="relations" class="section">
                <div class="card">
                    <h2>üîó Comment les Tables se Connectent</h2>

                    <h3>Relation 1 : Personne ‚Üí Utilisateur ‚Üí √âl√®ve</h3>
                    <div class="relationship">
                        <div class="table-box">personnes<br><small>id = 1</small></div>
                        <div class="arrow">‚Üí</div>
                        <div class="table-box">utilisateurs<br><small>personne_id = 1</small></div>
                        <div class="arrow">‚Üí</div>
                        <div class="table-box">eleves<br><small>utilisateur_id = 5</small></div>
                    </div>
                    <p><strong>Signification :</strong> La personne #1 a un compte utilisateur qui est un √©l√®ve.</p>

                    <h3>Relation 2 : √âl√®ve ‚Üí Inscription ‚Üí Classe</h3>
                    <div class="relationship">
                        <div class="table-box">eleves<br><small>id = 10</small></div>
                        <div class="arrow">‚Üí</div>
                        <div class="table-box">inscriptions<br><small>eleve_id = 10<br>classe_id = 3</small></div>
                        <div class="arrow">‚Üí</div>
                        <div class="table-box">classes<br><small>id = 3<br>6√®me A</small></div>
                    </div>
                    <p><strong>Signification :</strong> L'√©l√®ve #10 est inscrit en 6√®me A cette ann√©e.</p>

                    <h3>Relation 3 : Prof ‚Üí Affectation ‚Üí Classe + Mati√®re</h3>
                    <div class="relationship">
                        <div class="table-box">professeurs<br><small>id = 2</small></div>
                        <div class="arrow">‚Üí</div>
                        <div class="table-box">affectations_prof<br><small>prof_id = 2<br>classe_id = 3<br>matiere_id = 1</small></div>
                        <div class="arrow">‚Üí</div>
                        <div class="table-box">Cours<br><small>Math en 6√®me A</small></div>
                    </div>
                    <p><strong>Signification :</strong> Le prof #2 enseigne les Maths en 6√®me A.</p>

                    <h3>Relation 4 : Note compl√®te</h3>
                    <div class="flow-diagram">
                        <div class="flow-step">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                L'√©l√®ve Jean (eleves.id = 10) est inscrit en 6√®me A (inscriptions.id = 50)
                            </div>
                        </div>
                        <div class="flow-step">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                Le prof Rakoto (prof.id = 2) enseigne Math en 6√®me A (affectations.id = 15)
                            </div>
                        </div>
                        <div class="flow-step">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                Jean a eu 15/20 en Math (notes: inscription_id=50, affectation_id=15, valeur=15)
                            </div>
                        </div>
                    </div>

                    <div class="tip">
                        <strong>üí° R√®gle d'or :</strong> Pour lier deux tables, cherchez toujours un champ qui finit par "_id" !
                    </div>
                </div>
            </div>

            <!-- SECTION EXEMPLES SQL -->
            <div id="exemples" class="section">
                <div class="card">
                    <h2>üíª Exemples SQL Pratiques</h2>

                    <h3>Exemple 1 : R√©cup√©rer tous les √©l√®ves</h3>
                    <div class="example-code"><span class="keyword">SELECT</span> 
    e.id, 
    p.nom, 
    p.prenom, 
    e.matricule, 
    u.email
<span class="keyword">FROM</span> eleves e
<span class="keyword">JOIN</span> personnes p <span class="keyword">ON</span> e.personne_id = p.id
<span class="keyword">JOIN</span> utilisateurs u <span class="keyword">ON</span> e.utilisateur_id = u.id
<span class="keyword">WHERE</span> e.deleted_at <span class="keyword">IS NULL</span>;</div>

                    <div class="tip">
                        <strong>üìù Explication ligne par ligne :</strong>
                        <ul style="margin-top: 10px;">
                            <li><strong>SELECT</strong> : Choisir les colonnes √† afficher</li>
                            <li><strong>FROM eleves e</strong> : Table principale (e = alias)</li>
                            <li><strong>JOIN personnes p ON...</strong> : Connecter avec personnes via personne_id</li>
                            <li><strong>JOIN utilisateurs u ON...</strong> : Connecter avec utilisateurs via utilisateur_id</li>
                            <li><strong>WHERE deleted_at IS NULL</strong> : Ignorer les supprim√©s</li>
                        </ul>
                    </div>

                    <h3>Exemple 2 : √âl√®ves d'une classe</h3>
                    <div class="example-code"><span class="keyword">SELECT</span> 
    p.nom,
    p.prenom,
    CONCAT(c.niveau, <span class="string">' '</span>, c.nom) <span class="keyword">AS</span> classe
<span class="keyword">FROM</span> eleves e
<span class="keyword">JOIN</span> personnes p <span class="keyword">ON</span> e.personne_id = p.id
<span class="keyword">JOIN</span> inscriptions i <span class="keyword">
                        <div class="example-code"><span class="keyword">SELECT</span> 
    p.nom,
    p.prenom,
    CONCAT(c.niveau, <span class="string">' '</span>, c.nom) <span class="keyword">AS</span> classe
<span class="keyword">FROM</span> eleves e
<span class="keyword">JOIN</span> personnes p <span class="keyword">ON</span> e.personne_id = p.id
<span class="keyword">JOIN</span> inscriptions i <span class="keyword">ON</span> i.eleve_id = e.id
<span class="keyword">JOIN</span> classes c <span class="keyword">ON</span> i.classe_id = c.id
<span class="keyword">JOIN</span> annee_scolaire a <span class="keyword">ON</span> c.annee_scolaire_id = a.id
<span class="keyword">WHERE</span> a.actif = <span class="string">1</span>;</div>

                    <h3>Exemple 3 : Notes d'un √©l√®ve dans l'ann√©e active</h3>
                    <div class="example-code"><span class="keyword">SELECT</span>
    m.nom <span class="keyword">AS</span> matiere,
    p.nom <span class="keyword">AS</span> nom_prof,
    p.prenom <span class="keyword">AS</span> prenom_prof,
    n.valeur,
    n.sur_combien
<span class="keyword">FROM</span> notes n
<span class="keyword">JOIN</span> inscriptions i <span class="keyword">ON</span> n.inscription_id = i.id
<span class="keyword">JOIN</span> affectations_prof ap <span class="keyword">ON</span> n.affectation_id = ap.id
<span class="keyword">JOIN</span> matieres m <span class="keyword">ON</span> ap.matiere_id = m.id
<span class="keyword">JOIN</span> professeurs prof <span class="keyword">ON</span> ap.prof_id = prof.id
<span class="keyword">JOIN</span> personnes p <span class="keyword">ON</span> prof.personne_id = p.id
<span class="keyword">WHERE</span> i.eleve_id = <span class="string">10</span>  <span class="comment">-- ID de l'√©l√®ve</span>
<span class="keyword">AND</span> i.annee_scolaire_id = (SELECT id FROM annee_scolaire WHERE actif = 1);</div>

                    <h3>Exemple 4 : Moyenne par mati√®re pour un √©l√®ve</h3>
                    <div class="example-code"><span class="keyword">SELECT</span>
    m.nom <span class="keyword">AS</span> matiere,
    ROUND(AVG(n.valeur), 2) <span class="keyword">AS</span> moyenne
<span class="keyword">FROM</span> notes n
<span class="keyword">JOIN</span> affectations_prof ap <span class="keyword">ON</span> n.affectation_id = ap.id
<span class="keyword">JOIN</span> matieres m <span class="keyword">ON</span> ap.matiere_id = m.id
<span class="keyword">JOIN</span> inscriptions i <span class="keyword">ON</span> n.inscription_id = i.id
<span class="keyword">WHERE</span> i.eleve_id = <span class="string">10</span>
<span class="keyword">GROUP BY</span> m.nom
<span class="keyword">ORDER BY</span> moyenne <span class="keyword">DESC</span>;</div>
                </div>
            </div>

            <!-- SECTION EXEMPLES PHP -->
            <div id="php" class="section">
                <div class="card">
                    <h2>üêò Exemples PHP (avec PDO)</h2>

                    <h3>Connexion √† la base (config commune)</h3>
                    <div class="example-code"><span class="keyword">$dsn</span> = <span class="string">'mysql:host=localhost;dbname=ceg_fm;charset=utf8mb4'</span>;<br>
<span class="keyword">$options</span> = [<br>
&nbsp;&nbsp;PDO::ATTR_ERRMODE =&gt; PDO::ERRMODE_EXCEPTION,<br>
&nbsp;&nbsp;PDO::ATTR_DEFAULT_FETCH_MODE =&gt; PDO::FETCH_ASSOC<br>
];<br>
<span class="keyword">try</span> {<br>
&nbsp;&nbsp;<span class="keyword">$pdo</span> = <span class="keyword">new</span> PDO(<span class="keyword">$dsn</span>, <span class="string">'user'</span>, <span class="string">'password'</span>, <span class="keyword">$options</span>);<br>
} <span class="keyword">catch</span> (PDOException <span class="keyword">$e</span>) {<br>
&nbsp;&nbsp;<span class="keyword">die</span>(<span class="string">'Erreur connexion : '</span> . <span class="keyword">$e</span>-&gt;getMessage());<br>
}</div>

                    <h3>Exemple 1 : Lister les √©l√®ves d'une classe (ann√©e active)</h3>
                    <div class="example-code"><span class="keyword">$sql</span> = <span class="string">"SELECT p.nom, p.prenom, e.matricule, c.niveau, c.nom AS classe_nom
FROM eleves e
JOIN personnes p ON e.personne_id = p.id
JOIN inscriptions i ON i.eleve_id = e.id
JOIN classes c ON i.classe_id = c.id
JOIN annee_scolaire a ON c.annee_scolaire_id = a.id
WHERE a.actif = 1 AND c.id = :classe_id
ORDER BY p.nom"</span>;<br>
<span class="keyword">$stmt</span> = <span class="keyword">$pdo</span>-&gt;prepare(<span class="keyword">$sql</span>);<br>
<span class="keyword">$stmt</span>-&gt;execute([<span class="string">'classe_id'</span> =&gt; <span class="string">3</span>]);<br>
<span class="keyword">$eleves</span> = <span class="keyword">$stmt</span>-&gt;fetchAll();</div>

                    <h3>Exemple 2 : Ins√©rer une note (s√©curis√©)</h3>
                    <div class="example-code"><span class="keyword">$sql</span> = <span class="string">"INSERT INTO notes (inscription_id, affectation_id, valeur, sur_combien)
VALUES (:inscription, :affectation, :valeur, :sur)"</span>;<br>
<span class="keyword">$stmt</span> = <span class="keyword">$pdo</span>-&gt;prepare(<span class="keyword">$sql</span>);<br>
<span class="keyword">$stmt</span>-&gt;execute([<br>
&nbsp;&nbsp;<span class="string">'inscription'</span> =&gt; <span class="string">50</span>,<br>
&nbsp;&nbsp;<span class="string">'affectation'</span> =&gt; <span class="string">15</span>,<br>
&nbsp;&nbsp;<span class="string">'valeur'</span> =&gt; 16.5,<br>
&nbsp;&nbsp;<span class="string">'sur'</span> =&gt; 20<br>
]);<br>
<span class="keyword">echo</span> <span class="string">"Note enregistr√©e !"</span>;</div>

                    <div class="warning">
                        <strong>‚ö†Ô∏è Toujours utiliser prepare() + execute()</strong> pour √©viter les injections SQL !
                    </div>
                </div>
            </div>

            <!-- SECTION SCENARIOS -->
            <div id="scenarios" class="section">
                <div class="card">
                    <h2>üéØ Sc√©narios Courants Expliqu√©s</h2>

                    <h3>Sc√©nario 1 : Inscrire un nouvel √©l√®ve</h3>
                    <div class="flow-diagram">
                        <div class="flow-step">
                            <div class="step-number">1</div>
                            <div class="step-content">Ins√©rer dans <strong>personnes</strong> ‚Üí r√©cup√©rer l‚Äôid</div>
                        </div>
                        <div class="flow-step">
                            <div class="step-number">2</div>
                            <div class="step-content">Ins√©rer dans <strong>utilisateurs</strong> (email, password_hash, r√¥le=eleve)</div>
                        </div>
                        <div class="flow-step">
                            <div class="step-number">3</div>
                            <div class="step-content">Ins√©rer dans <strong>eleves</strong> avec les deux ids + matricule</div>
                        </div>
                        <div class="flow-step">
                            <div class="step-number">4</div>
                            <div class="step-content">Ins√©rer dans <strong>inscriptions</strong> (eleve_id + classe_id de l‚Äôann√©e active)</div>
                        </div>
                    </div>

                    <h3>Sc√©nario 2 : Changer un √©l√®ve de classe l‚Äôann√©e suivante</h3>
                    <div class="tip">
                        <strong>üí° Simple :</strong> Il suffit d‚Äôajouter une nouvelle ligne dans <strong>inscriptions</strong> pour la nouvelle ann√©e/classe. L‚Äôancienne reste pour l‚Äôhistorique !
                    </div>

                    <h3>Sc√©nario 3 : Supprimer logiquement un utilisateur</h3>
                    <div class="success">
                        <strong>‚úÖ Bonne pratique :</strong> Ne jamais DELETE physique. Ajouter un champ <code>deleted_at</code> (soft delete) dans les tables concern√©es et filtrer avec <code>WHERE deleted_at IS NULL</code>.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(sec => {
                sec.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');

            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.nav-btn[onclick="showSection('${sectionId}')"]`).classList.add('active');
        }
    </script>
</body>
</html>